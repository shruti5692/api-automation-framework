public static Set<String> fetchOpenChargeData(String chargeId) throws Exception {
    String query =
        "SELECT A.CHG_ID, B.OPEN_CLO_STA, A.CHG_FORM_STA, A.ACYC_CNT " +
        "FROM INTST02.SEC_CHARGE AS A, INTST02.CUD_PROD_RELN AS B " +
        "WHERE A.CHG_ID = B.PROD_ID AND A.CHG_ID=?";

    List<Map<String, Object>> rows = DBUtils.executeQuery(query, chargeId);
    Set<String> result = new HashSet<>();

    for (Map<String, Object> row : rows) {
        Map<String, Object> normalized = new HashMap<>();
        for (Map.Entry<String, Object> e : row.entrySet()) {
            normalized.put(e.getKey().toUpperCase(), e.getValue());
        }
        String chgId      = String.valueOf(normalized.get("CHG_ID")).trim();
        String openSta    = String.valueOf(normalized.get("OPEN_CLO_STA")).trim();
        String formStatus = String.valueOf(normalized.get("CHG_FORM_STA")).trim();
        String acycCnt    = String.valueOf(normalized.get("ACYC_CNT")).trim();

        result.add(chgId + "|" + openSta + "|" + formStatus + "|" + acycCnt);
    }

    return result;
}
