package tests;

import org.framework.utils.DBUtils;
import java.util.*;

public class DbFetchHelper {

    public static List<Map<String, String>> fetchData(String query, Object... params) throws Exception {

        List<Map<String, Object>> rows = DBUtils.executeQuery(query, params);
        List<Map<String, String>> normalizedData = new ArrayList<>();

        for (Map<String, Object> row : rows) {
            Map<String, String> normalizedRow = new HashMap<>();

            for (Map.Entry<String, Object> entry : row.entrySet()) {
                String key = entry.getKey().toUpperCase();
                String value = entry.getValue() != null ? entry.getValue().toString().trim() : "";
                normalizedRow.put(key, value);
            }

            // âœ… add once per row
            normalizedData.add(normalizedRow);
        }

        return normalizedData;
    }
}
