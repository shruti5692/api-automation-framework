package tests;

import org.framework.utils.DBUtils;
import java.util.*;

public class DbFetchHelper {

    private static final String QUERY =
        "SELECT CUST_NO, PROD_ID, PROD_COD " +
        "FROM INTST02.CUD_PROD_RELN " +
        "WHERE CUST_NO = ? " +
        "  AND LENGTH(RTRIM(PROD_ID)) = 14 " +
        "  AND OPEN_CLO_STA = 'O'";

    public static void main(String[] args) throws Exception {
        String customerNo = args.length > 0 ? args[0] : "1104165104";

        // Directly get rows and print
        for (Map<String, Object> row : DBUtils.executeQuery(QUERY, customerNo)) {
            String custNo  = String.valueOf(row.get("CUST_NO")).trim();
            String prodId  = String.valueOf(row.get("PROD_ID")).trim();
            String prodCod = String.valueOf(row.get("PROD_COD")).trim();

            System.out.println(
                "CUST_NO=" + custNo +
                ", PROD_ID=" + prodId +
                ", PROD_COD=" + prodCod
            );
        }
    }
}
