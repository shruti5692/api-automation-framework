package com.framework.config;

import java.io.File;
import java.io.FileInputStream;
import java.util.Properties;

/**
 * Loads application properties. Use ConfigManager.load(path) at startup.
 * Keys used by the framework:
 *  - base.url
 *  - excel.path
 *  - excel.sheet
 *  - encryption.key
 */
public class ConfigManager {
    private static final Properties props = new Properties();

    public static void load(String path) throws Exception {
        try (FileInputStream fis = new FileInputStream(path)) {
            props.load(fis);
        }
    }

    public static String get(String key) {
        return props.getProperty(key);
    }

    /**
     * Returns the encryption key path (if file) or raw value as configured.
     * If property value points to an existing file, this method returns the file path.
     */
    public static String getEncryptionKeyPathOrValue() {
        String raw = props.getProperty("encryption.key");
        if (raw == null) return null;
        File f = new File(raw);
        return f.exists() ? raw : raw;
    }
}
