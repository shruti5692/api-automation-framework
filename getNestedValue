private String getNestedValue(JSONObject json, String path) {
    String[] parts = path.split("\\.");
    Object current = json;

    for (String part : parts) {
        if (part.contains("[") && part.contains("]")) {
            // Handle array index
            String key = part.substring(0, part.indexOf("["));
            int index = Integer.parseInt(part.substring(part.indexOf("[") + 1, part.indexOf("]")));
            if (current instanceof JSONObject && ((JSONObject) current).has(key)) {
                JSONArray arr = ((JSONObject) current).optJSONArray(key);
                if (arr != null && arr.length() > index) current = arr.get(index);
                else return "MISSING";
            } else return "MISSING";
        } else {
            if (current instanceof JSONObject && ((JSONObject) current).has(part)) {
                current = ((JSONObject) current).get(part);
            } else return "MISSING";
        }
    }

    return current == null ? "MISSING" : String.valueOf(current).trim();
}
