public static String captureDbEvidence(String testCaseId) throws Exception {
    Path dir = Paths.get(SCREENSHOT_DIR).toAbsolutePath();
    if (!Files.exists(dir)) {
        Files.createDirectories(dir);
    }

    // Screenshot file produced by macro
    String screenshotPath = dir.resolve(testCaseId + ".bmp").toString();

    ProcessBuilder pb = new ProcessBuilder(
            PCOMM_EXE,
            SESSION_FILE,
            "/R",
            MACRO_FILE
    );
    pb.redirectErrorStream(true);

    Process process = pb.start();
    try (BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()))) {
        String line;
        while ((line = reader.readLine()) != null) {
            System.out.println("[PCOMM] " + line);
        }
    }

    int exitCode = process.waitFor();
    if (exitCode != 0) {
        throw new RuntimeException("Macro execution failed with exit code " + exitCode);
    }

    System.out.println("Macro executed successfully. Screenshot expected at: " + screenshotPath);
    return screenshotPath;
}
