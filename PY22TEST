package com.framework.tests;

import com.framework.core.RunThis;
import com.framework.utils.*;
import org.testng.annotations.*;

import java.util.*;

@Listeners(com.framework.core.RunThis.Filter.class)
public class PY22Test {

    private static final String EXCEL_PATH = "src/test/resources/testdata/PY22.xlsx";
    private static final String SHEET_NAME = "PY22";

    @DataProvider(name = "py22Data")
    public Object[][] py22Data() throws Exception {
        List<Map<String, String>> data = ExcelUtils.readSheet(EXCEL_PATH, SHEET_NAME);
        Object[][] arr = new Object[data.size()][1];
        for (int i = 0; i < data.size(); i++) arr[i][0] = data.get(i);
        return arr;
    }

    @RunThis(id = "PY22_TC01")  // âœ… only this test will run
    @Test(dataProvider = "py22Data")
    public void callPY22Api(Map<String, String> row) throws Exception {
        ApiUtils.runApiTest(row);
    }

    @Test(dataProvider = "py22Data")
    public void anotherApi(Map<String, String> row) throws Exception {
        ApiUtils.runApiTest(row);  // ðŸš« will be skipped automatically
    }
}
