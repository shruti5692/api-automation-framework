package com.framework.tests;

import com.framework.utils.*;
import org.testng.Assert;
import org.testng.annotations.Test;
import java.util.Map;

public class PY22Test {

    @Test(description = "TC01 - Validate Positive PY22 API Response")
    public void TC01_PositiveResponse() {
        String url = ConfigReader.get("py22.api.url");
        String username = ConfigReader.get("username");
        String password = ConfigReader.get("password");

        // Example values from Excel
        String branchNum = "4000";
        String accNum = "0219003789";
        String prodId = branchNum + accNum;

        // Prepare headers
        Map<String, String> headers = HeaderUtils.getPy22Headers(prodId);

        // Hit API
        Map<String, String> apiResponse = ApiUtils.callApi(url, headers, username, password);

        // ---- Validations ----
        String statusCode = apiResponse.getOrDefault("statusCode", "");
        String responseCode = apiResponse.getOrDefault("responseMessage.responseHeader.responseCode", "");

        System.out.println("Status Code from API: " + statusCode);
        System.out.println("Response Code from API: " + responseCode);

        Assert.assertEquals(statusCode, "200", "Expected HTTP 200");
        Assert.assertEquals(responseCode, "0", "Expected responseCode=0");

        System.out.println("âœ… TC01 Passed - Response successfully validated.");
    }
}
