On Error Resume Next

Dim connList, psObj, sessionName
Set connList = CreateObject("PCOMM.autECLConnList")

If connList.Count = 0 Then
    WScript.Echo "No sessions found."
    WScript.Quit 1
End If

sessionName = connList(1).Name
WScript.Echo "Attaching to session: " & sessionName

Set psObj = CreateObject("PCOMM.autECLPS")
psObj.SetConnectionByName sessionName

' Wait for the session to be available
WScript.Sleep 2000  ' 2 seconds delay
psObj.WaitForAppAvailable
psObj.WaitForScreenReady

' Try capturing the first line only
Dim line1
line1 = psObj.GetText(1,1,1,80)
WScript.Echo "First line: [" & line1 & "]"
