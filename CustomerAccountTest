package tests;

import org.framework.utils.ConfigManager;
import org.framework.utils.DBUtils;
import org.framework.utils.ExcelUtils;
import org.framework.utils.JwtFetcher;
import org.testng.Assert;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import java.util.*;

/**
 * Reads test rows from Excel, fetches JWT, calls API, then validates
 * API response against DB data (CUD_PROD_RELN).
 */
public class CustomerAccountTest {

    private static final String EXCEL_PATH = System.getProperty("user.dir") + "/TestData.xlsx";
    private static final String AUTH_SHEET = "Auth";
    private static final String CASE_SHEET = "TestCases";

    @DataProvider(name = "cases")
    public Object[][] cases() throws Exception {
        List<Map<String,String>> rows = ExcelUtils.readSheet(EXCEL_PATH, CASE_SHEET);
        Object[][] data = new Object[rows.size()][1];
        for
